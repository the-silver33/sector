<!DOCTYPE html>
<html lang="it">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Griglia 60x80</title>
	<style>
		
		body {
			margin: 0;
			font-family: Arial, sans-serif;
		}

		.grid-button {
			padding: 10px 20px;
			background-color: #4CAF50;
			color: white;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			font-size: 16px;
			transition: background-color 0.3s;
		}

		.grid-button:hover {
			background-color: #45a049;
		}

		.grid-container {
			display: grid;
			margin: 10px auto;
			border: 1px solid #ccc;
			background-color: #f0f0f0;
			transform-origin: 0 0;
			overflow: scroll;
			width: max-content;
			height: max-content;
		}

		.grid-cell {
			background-color: white;
			border: 1px solid #e0e0e0;
			transition: background-color 0.2s;
			width: 10px;
			height: 10px;
		}

		#zoom-container {
			overflow: auto;
		}
	</style>
</head>

<body>
	<h1>Mappa</h1>

	<button class="grid-button" onclick="handleButtonClick()">Cliccami!</button>

	<div id="zoom-container">
		<div class="grid-container" id="grid">
			<!-- La griglia verrÃ  generata dinamicamente con JavaScript -->
		</div>
	</div>

	<script>
		const gridContainer = document.getElementById('grid');
		let zoom = 1;

		function createGrid(rows, cols, data) {
			gridContainer.innerHTML = '';
			gridContainer.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
			gridContainer.style.gridTemplateRows = `repeat(${rows}, 1fr)`;

			for (let r = 0; r < rows; r++) {
				for (let c = 0; c < cols; c++) {
					const cell = document.createElement('div');
					cell.className = 'grid-cell';
					cell.textContent = data[r] && data[r][c] ? data[r][c] : '';
					gridContainer.appendChild(cell);
				}
			}
		}

		// Funzione per il bottone
		function handleButtonClick() {
			window.location.href = 'https://the-silver33.github.io/sector/test.html';
		}

		// Funzione zoom
		let zoomContainer = document.getElementById("zoom-container");
		zoomContainer.addEventListener("wheel", e => {
			if (!e.ctrlKey) return;   // evita interferenze con lo scroll normale
			e.preventDefault();

			zoom += e.deltaY * -0.001;
			zoom = Math.min(Math.max(zoom, 1), 3); // limiti

			gridContainer.style.transform = `scale(${zoom})`;
		});

		document.addEventListener("keydown", (e) => {
			const step = 50;  // distanza scroll ad ogni pressione

			switch (e.key.toLowerCase()) {
				case "arrowup": case "w":
					zoomContainer.scrollTop -= step;
					break;
				case "arrowdown": case "s":
					zoomContainer.scrollTop += step;
					break;
				case "arrowleft": case "a":
					zoomContainer.scrollLeft -= step;
					break;
				case "arrowright": case "d":
					zoomContainer.scrollLeft += step;
					break;
			}
		});

		// --- Google Sheet ---
    // ID del tuo foglio (dalla URL: https://docs.google.com/spreadsheets/d/FOGLIO_ID/edit)
    const SHEET_ID = '1Uoz5xYisxmd7uUUIFrsAX-yZ4mckYSUdSopG2pNaL1k';
    // Nome del sheet/tab
    const SHEET_NAME = 'mappa';

    async function loadSheetData() {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=AIzaSyAjSe4WyZIJyGk5HLMMytZcm_s4xQJKNU4`;
      try {
        const res = await fetch(url);
        const json = await res.json();
				console.log(json)
        const data = json.values;
        const rows = data.length;
        const cols = data[0] ? data[0].length : 0;
        createGrid(rows, cols, data);
      } catch (err) {
        console.error('Errore caricamento Google Sheet', err);
      }
    }

		// popola la griglia
    window.addEventListener('DOMContentLoaded', loadSheetData);
	</script>
</body>

</html>
